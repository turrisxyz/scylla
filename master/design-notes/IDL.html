

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             IDL compiler | Scylla Docs 
        </title>
        <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://scylla.docs.scylladb.com/stable/design-notes/IDL.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
            
        
    
        
        
            

        <script type="text/javascript" id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
            
        
            
        
            
                <script src="../_static/underscore.js"></script>
            
        
            
                <script src="../_static/doctools.js"></script>
            
        
            
                <script src="../_static/clipboard.min.js"></script>
            
        
            
                <script src="../_static/copybutton.js"></script>
            
        
    
            <!-- Google Tag Manager -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/logo-docs.svg" alt="Scylla Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--about-us"></i>
                            Scylla Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--enterprise"></i>Scylla Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="scylla-icon scylla-icon--overview"></i>
                            Scylla Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Cloud <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://cloud.scylladb.com/">
                            <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
                            Docs</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle" data-toggle="side-nav">
    <div class="side-nav-toggle__button">
        <img src="../_static/img/menu.svg" alt="Menu" />
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for an unstable version of Scylla Dev.
            
            <a href="../../stable/design-notes/IDL.html">Switch to the latest stable version.</a>
        </p>
    </div>

                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://scylla.docs.scylladb.com"
            class="bread__highlight">
            <i class="fas fa-home"></i> Scylla Dev
        </a>
    </span>
    
        <span class="bread__item">
            <a href="index.html">
                Design Notes
            </a>
        </span>
    
    <span class="bread__item bread__item--last">IDL compiler</span>
</div>
                    </div>
                
                <section id="idl-compiler">
<h1>IDL compiler<a class="headerlink" href="#idl-compiler" title="Permalink to this headline">¶</a></h1>
<p>IDL compiler is a tool written in Python, that generates utility serialization/de-serialization code (specializations
for <code class="docutils literal notranslate"><span class="pre">ser::serializer&lt;T&gt;</span></code> class) for C++ classes and enums. It takes an IDL definition file as input and generates two
files from it: <code class="docutils literal notranslate"><span class="pre">&lt;mod_name&gt;.dist.hh</span></code>, which is declarations part, and <code class="docutils literal notranslate"><span class="pre">&lt;mod_name&gt;.dist.impl.hh</span></code>, which contains generated
code definitions (private part).</p>
<p>The syntax of IDL is similar to C++ to some degree (e.g. contains <code class="docutils literal notranslate"><span class="pre">struct/class</span></code> and <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">class</span></code> constructs), but is
also extended to support more complex things in the context of RPC serialization: RPC messages (also called
“RPC verbs”).</p>
<p>By default, all generated code for Scylla is created under <code class="docutils literal notranslate"><span class="pre">ser</span></code> namespace.</p>
<section id="file-syntax-description">
<h2>File syntax description<a class="headerlink" href="#file-syntax-description" title="Permalink to this headline">¶</a></h2>
<p>As noted above, the syntax of IDL definitions file resembles C++ by providing similar-looking code constructs for class
and enum serializers.</p>
<p>The IDL file contains a sequence of entity declarations, most of which correspond directly to those from the actual
C++ code:</p>
<ul class="simple">
<li><p>Namespaces (<code class="docutils literal notranslate"><span class="pre">namespace</span></code>)</p></li>
<li><p>Classes / structures (<code class="docutils literal notranslate"><span class="pre">class</span></code> / <code class="docutils literal notranslate"><span class="pre">struct</span></code>)</p></li>
<li><p>Enums (<code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">class</span></code>)</p></li>
<li><p>RPC verbs (<code class="docutils literal notranslate"><span class="pre">verb</span></code>)</p></li>
</ul>
<p>Classes can be templated, supporting the ordinary <code class="docutils literal notranslate"><span class="pre">template</span> <span class="pre">&lt;typename</span> <span class="pre">T&gt;</span></code>-style notation at the beginning of the class
declaration, similar to C++.</p>
<p>Some places (e.g. classes, class members and RPC verbs) also support modifying generation behavior by providing
attribute sequences (via C++ syntax of <code class="docutils literal notranslate"><span class="pre">[[attr]]</span></code> form).</p>
<section id="namespaces">
<h3>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline">¶</a></h3>
<p>Namespaces in IDL act the same way as in C++ or any other programming language, and can have arbitrary nesting depth.
Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">namespace</span> <span class="o">&lt;</span><span class="n">ns</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">namespace</span><span class="o">-</span><span class="n">body</span><span class="o">&gt;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ns-name</span></code> — namespace identifier. Directly corresponds to the namespace from C++, defining a new namespace or
extending an existing one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">namespace-body</span></code> — a sequence of 0+ nested entities of any kind: classes, enums, RPC verbs or other nested
namespaces.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">namespace</span> <span class="n">ns</span> <span class="p">{</span>

<span class="k">class</span> <span class="nc">my_class</span> <span class="p">{</span>
    <span class="nb">int</span> <span class="n">a</span><span class="p">;</span>
    <span class="nb">bool</span> <span class="n">b</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">enum</span> <span class="k">class</span> <span class="nc">e</span> <span class="p">{</span>
    <span class="n">E1</span><span class="p">,</span>
    <span class="n">E2</span>
<span class="p">};</span>

<span class="o">//</span> <span class="o">...</span>

<span class="p">}</span> <span class="o">//</span> <span class="n">namespace</span> <span class="n">ns</span>
</pre></div>
</div>
</section>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p>Class declaration creates a <code class="docutils literal notranslate"><span class="pre">ser::serializer&lt;T&gt;</span></code> specialization для for a class with a given name, along with an
implementation of <code class="docutils literal notranslate"><span class="pre">write</span></code>, <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">skip</span></code> methods. Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="n">template</span><span class="o">-</span><span class="n">parameter</span><span class="o">-</span><span class="nb">list</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span>
<span class="n">class</span><span class="o">-</span><span class="n">key</span> <span class="o">&lt;</span><span class="n">class</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="n">final</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="n">attributes_seq</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="n">stub</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">nested</span><span class="o">-</span><span class="n">class</span><span class="o">&gt;</span> <span class="o">|</span> <span class="o">&lt;</span><span class="n">member</span><span class="o">-</span><span class="n">specification</span><span class="o">&gt;</span> <span class="p">}</span> <span class="p">;(</span><span class="n">optional</span><span class="p">)</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template-parameter-list</span></code> - the list of template arguments in case a class is a template.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">class-key</span></code> - either <code class="docutils literal notranslate"><span class="pre">class</span></code>, or <code class="docutils literal notranslate"><span class="pre">struct</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">class-name</span></code> - class identifier, for which <code class="docutils literal notranslate"><span class="pre">ser::serializer&lt;T&gt;</span></code> specialization is to be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">final</span></code> specifier — an optimization option, which denotes that a class is final, i.e. cannot be extended in the
future, in which case the size is not serialized. Should be used with care.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stub</span></code> specifier — skip generating serialization code for a class. Initially designed for documentation within IDL
(there is one exception to that with <code class="docutils literal notranslate"><span class="pre">[[writable]]</span></code> attribute, though. More on that below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributes_seq</span></code> - optional sequence of C++-style attributes. Only <code class="docutils literal notranslate"><span class="pre">[[writable]]</span></code> attribute is supported at the
moment, which means that: if specified, the writers and serialization  views will also be generated for a class
(inside the private <code class="docutils literal notranslate"><span class="pre">&lt;mod_name&gt;.dist.impl.hh</span></code> part). Other attributes are ignored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nested-class</span></code> - nested class definition following the same syntax.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">member-specification</span></code> — data members and getter functions declarations (more details on the syntax below). Getter
functions should be used in cases where access to private class fields is needed. Both kinds of field accessors can
also be marked with <code class="docutils literal notranslate"><span class="pre">[[version</span> <span class="pre">id]]</span></code> version attribute, which denotes, that a field is accessible starting from
version <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p></li>
</ul>
<p>A class declaration can optionally include a semicolon at the end to more closely resemble C++ syntax.</p>
<p>If a class contains both <code class="docutils literal notranslate"><span class="pre">stub</span></code> specifier and <code class="docutils literal notranslate"><span class="pre">[[writable]]</span></code> attribute at the same time, the <code class="docutils literal notranslate"><span class="pre">ser::serializer</span></code> code is
not generated but the serialization views (classes with <code class="docutils literal notranslate"><span class="pre">_view</span></code> suffix in the name, that support reading and writing
data in the stream according to some fixed data layout) are created, nonetheless.</p>
<p>Class members are declared the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="n">name</span> <span class="o">&lt;</span><span class="n">getter</span><span class="o">-</span><span class="n">marker</span><span class="o">&gt;</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="p">[[</span><span class="n">version</span> <span class="n">version</span><span class="o">-</span><span class="nb">id</span><span class="p">]](</span><span class="n">optional</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">default</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span><span class="p">(</span><span class="n">optional</span><span class="p">);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - any valid C++ type, following the regular C++ syntax. Naturally, a serializer specialization for this
type should exist in order to serialize/deserialize it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - accessor name. For ordinary data fields it is just a C++ name of a class field. In case it’s a getter
function, it also should contain a “getter marker”, which is denoted as empty <code class="docutils literal notranslate"><span class="pre">()</span></code> braces sequence right after the
name. As noted above, getter functions should be used if a field is not accessible (i.e. is private), otherwise a
regular data field can be used. Note, that getter functions can (and probably should) be const methods.</p></li>
<li><p>version attribute — specify that a field is accessible starting from version <code class="docutils literal notranslate"><span class="pre">version-id</span></code> and above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default-value</span></code> — an optional clause to specify default value for a field accessor. The syntax is: <code class="docutils literal notranslate"><span class="pre">=</span> <span class="pre">&lt;value&gt;</span></code>.</p></li>
</ul>
</section>
<section id="enums">
<h3>Enums<a class="headerlink" href="#enums" title="Permalink to this headline">¶</a></h3>
<p>Analogous to classes, <code class="docutils literal notranslate"><span class="pre">ser::serializer&lt;T&gt;</span></code> specializations can also be generated for enums. Declaration syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enum</span> <span class="k">class</span> <span class="nc">identifier</span> <span class="n">enum</span><span class="o">-</span><span class="n">base</span> <span class="p">{</span> <span class="n">enumerator</span><span class="o">-</span><span class="nb">list</span> <span class="p">}</span> <span class="p">;(</span><span class="n">optional</span><span class="p">)</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">identifier</span></code> - the name of C++ enum class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enum-base</span></code> - mandatory specification of C++ underlying type for the enum, following the regular C++ syntax: <code class="docutils literal notranslate"><span class="pre">:</span> <span class="pre">integer-type</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enumerator-list</span></code> - a list of enum cases or initializers of the following form: <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">integer-value</span></code>, where
<code class="docutils literal notranslate"><span class="pre">integer-value</span></code> is a plain integer literal value.</p></li>
</ul>
<p>Note that although C++ allows <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> as an initializer value, it makes the documentation less readable, hence is
not permitted.</p>
</section>
<section id="rpc-verbs">
<h3>RPC Verbs<a class="headerlink" href="#rpc-verbs" title="Permalink to this headline">¶</a></h3>
<p>IDL can also contain declarations of RPC messages with a given signature (also called: “RPC verbs”). It allows to
automatically generate boilerplate code for message handlers registration and message passing code via an instance of
<code class="docutils literal notranslate"><span class="pre">netw::messaging_service</span></code> class. Declaration syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verb</span> <span class="nb">id</span> <span class="p">[[</span><span class="n">attributes</span><span class="o">...</span><span class="p">]](</span><span class="n">optional</span><span class="p">)</span> <span class="p">(</span><span class="n">parameters</span><span class="o">...</span><span class="p">)</span> <span class="p">(</span><span class="o">-&gt;</span> <span class="k">return</span><span class="o">-</span><span class="nb">type</span><span class="o">...</span><span class="p">)(</span><span class="n">optional</span><span class="p">)</span> <span class="p">;(</span><span class="n">optional</span><span class="p">)</span>
</pre></div>
</div>
<p>There should be a corresponding upper-cased enumerator <code class="docutils literal notranslate"><span class="pre">ID</span></code> inside the <code class="docutils literal notranslate"><span class="pre">netw::messaging_verb</span></code> enum for a verb with name
<code class="docutils literal notranslate"><span class="pre">id</span></code>. For example, for a <code class="docutils literal notranslate"><span class="pre">my_verb</span></code> declaration there should be a corresponding <code class="docutils literal notranslate"><span class="pre">netw::messaging_verb::MY_VERB</span></code> constant
to specify an id for the RPC client.</p>
<p>The parameters of the verb declarations will also act as parameters for the handler functions and corresponding <code class="docutils literal notranslate"><span class="pre">send</span></code>
functions. In case <code class="docutils literal notranslate"><span class="pre">[[with_timeout]]</span></code> attribute is set, the argument list is extended with a <code class="docutils literal notranslate"><span class="pre">time_point</span></code> argument at the
beginning of the parameter list to specify an RPC timeout when sending or handling the message.</p>
<p>The return value type is calculated as <code class="docutils literal notranslate"><span class="pre">future&lt;return_type&gt;</span></code> if only one type is present and
<code class="docutils literal notranslate"><span class="pre">future&lt;rpc::tuple&lt;type1,</span> <span class="pre">type2,</span> <span class="pre">...&gt;&gt;</span></code> if there are more then one. It is used as return type for message handler and <code class="docutils literal notranslate"><span class="pre">send</span></code>
function. If the <code class="docutils literal notranslate"><span class="pre">-&gt;</span> <span class="pre">return</span> <span class="pre">type</span></code> clause is omitted, the return type is assumed to be <code class="docutils literal notranslate"><span class="pre">future&lt;&gt;</span></code>. If <code class="docutils literal notranslate"><span class="pre">[[one_way]]</span></code>
attribute is specified, handler function return type is fixed to <code class="docutils literal notranslate"><span class="pre">future&lt;rpc::no_wait_type&gt;</span></code>, and the return type
clause should not be used, otherwise an exception will be thrown during  IDL generation process.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">[[with_client_info]]</span></code> attribute is used then the handler will contain a const reference to  an <code class="docutils literal notranslate"><span class="pre">rpc::client_info</span></code> as
its first argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[with_client_info]]</span></code>, <code class="docutils literal notranslate"><span class="pre">[[with_timeout]]</span></code> and <code class="docutils literal notranslate"><span class="pre">[[one_way]]</span></code> attributes can be combined.</p>
<p>For an RPC verb with the definition of <code class="docutils literal notranslate"><span class="pre">verb</span> <span class="pre">x</span> <span class="pre">(arg1_t,</span> <span class="pre">arg2_t)</span> <span class="pre">-&gt;</span> <span class="pre">ret_t;</span></code> , which is defined in some <code class="docutils literal notranslate"><span class="pre">my_mod.idl.hh</span></code>
module, the following <code class="docutils literal notranslate"><span class="pre">my_mod_rpc_verbs</span></code> class will be generated (approximately):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// my_mod.dist.hh</span>

<span class="k">namespace</span> <span class="n">ser</span> <span class="p">{</span>

<span class="k">struct</span> <span class="n">my_mod_rpc_verbs</span> <span class="p">{</span>
	<span class="k">static</span> <span class="kt">void</span> <span class="n">register_x</span><span class="p">(</span><span class="n">netw</span><span class="o">::</span><span class="n">messaging_service</span><span class="o">*</span> <span class="n">ms</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">future</span><span class="o">&lt;</span><span class="n">ret_t</span><span class="o">&gt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">rpc</span><span class="o">::</span><span class="n">client_info</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">arg1_t</span><span class="p">,</span> <span class="n">arg2_t</span><span class="o">&gt;&amp;&amp;</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">future</span><span class="o">&lt;&gt;</span> <span class="n">unregister_x</span><span class="p">(</span><span class="n">netw</span><span class="o">::</span><span class="n">messaging_service</span><span class="o">*</span> <span class="n">ms</span><span class="p">);</span>
	<span class="k">static</span> <span class="n">future</span><span class="o">&lt;</span><span class="n">ret_t</span><span class="o">&gt;</span> <span class="n">send_x</span><span class="p">(</span><span class="n">netw</span><span class="o">::</span><span class="n">messaging_service</span><span class="o">*</span> <span class="n">ms</span><span class="p">,</span> <span class="n">netw</span><span class="o">::</span><span class="n">msg_addr</span> <span class="n">id</span><span class="p">,</span> <span class="n">arg1_t</span><span class="p">,</span> <span class="n">arg2_t</span><span class="p">);</span>

	<span class="c1">// calls unregister_x, and the same for other verbs, if there are any,</span>
  <span class="c1">// and waits for all of them to resolve.</span>
	<span class="k">static</span> <span class="n">future</span><span class="o">&lt;&gt;</span> <span class="n">unregister</span><span class="p">(</span><span class="n">netw</span><span class="o">::</span><span class="n">messaging_service</span><span class="o">*</span> <span class="n">ms</span><span class="p">);</span>
<span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace ser</span>
</pre></div>
</div>
<p>Each parameter can optionally have a name, otherwise a placeholder name of form <code class="docutils literal notranslate"><span class="pre">_N</span></code> will be used, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the
index within the RPC verb parameters list. Also, each argument and return type can be annotated with <code class="docutils literal notranslate"><span class="pre">[[version</span> <span class="pre">id]]</span></code>
attribute, which will cause it to be accepted as a <code class="docutils literal notranslate"><span class="pre">rpc::optional&lt;&gt;</span></code> in the handler function signature or returned by send()
function respectively,</p>
<p>If a parameter is annotated with [[ref]] attribute send function will receive it as a const reference, but a handler
will still receive it by value.</p>
<p>Return type value can be also annotated with <code class="docutils literal notranslate"><span class="pre">[[unique_ptr]]</span></code> or <code class="docutils literal notranslate"><span class="pre">[[lw_shared_ptr]]</span></code> attributes. If the attribute is present
handler function’s return value will have the type as <code class="docutils literal notranslate"><span class="pre">foreign_ptr&lt;unique_ptr&lt;&gt;&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">foreign_ptr&lt;lw_shared_ptr&lt;&gt;&gt;</span></code> respectively.</p>
</section>
</section>
<section id="idl-example">
<h2>IDL example<a class="headerlink" href="#idl-example" title="Permalink to this headline">¶</a></h2>
<p>Forward slashes comments are ignored until the end of the line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">namespace</span> <span class="n">utils</span> <span class="p">{</span>
<span class="o">//</span> <span class="n">An</span> <span class="n">example</span> <span class="n">of</span> <span class="n">a</span> <span class="n">stub</span> <span class="k">class</span>
<span class="nc">class</span> <span class="n">UUID</span> <span class="n">stub</span> <span class="p">{</span>
    <span class="n">int64_t</span> <span class="n">most_sig_bits</span><span class="p">;</span>
    <span class="n">int64_t</span> <span class="n">least_sig_bits</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="n">namespace</span> <span class="n">gms</span> <span class="p">{</span>
<span class="o">//</span><span class="n">an</span> <span class="n">enum</span> <span class="n">example</span>
<span class="n">enum</span> <span class="k">class</span> <span class="nc">application_state</span><span class="p">:</span><span class="nb">int</span> <span class="p">{</span><span class="n">STATUS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">LOAD</span><span class="p">,</span>
        <span class="n">SCHEMA</span><span class="p">,</span>
        <span class="n">DC</span><span class="p">};</span>

<span class="o">//</span> <span class="n">example</span> <span class="n">of</span> <span class="n">final</span> <span class="k">class</span>
<span class="nc">class</span> <span class="n">versioned_value</span> <span class="n">final</span> <span class="p">{</span>
<span class="o">//</span> <span class="n">getter</span> <span class="ow">and</span> <span class="n">setter</span> <span class="k">as</span> <span class="n">public</span> <span class="n">member</span>
    <span class="nb">int</span> <span class="n">version</span><span class="p">;</span>
    <span class="n">sstring</span> <span class="n">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">heart_beat_state</span> <span class="p">{</span>
<span class="o">//</span><span class="n">getter</span> <span class="k">as</span> <span class="n">function</span>
    <span class="n">int32_t</span> <span class="n">get_generation</span><span class="p">();</span>
<span class="o">//</span><span class="n">default</span> <span class="n">value</span> <span class="n">example</span>
    <span class="n">int32_t</span> <span class="n">get_heart_beat_version</span><span class="p">()</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">endpoint_state</span> <span class="p">{</span>
    <span class="n">heart_beat_state</span> <span class="n">get_heart_beat_state</span><span class="p">();</span>
    <span class="n">std</span><span class="p">::</span><span class="nb">map</span><span class="o">&lt;</span><span class="n">application_state</span><span class="p">,</span> <span class="n">versioned_value</span><span class="o">&gt;</span> <span class="n">get_application_state_map</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">gossip_digest</span> <span class="p">{</span>
    <span class="n">inet_address</span> <span class="n">get_endpoint</span><span class="p">();</span>
    <span class="n">int32_t</span> <span class="n">get_generation</span><span class="p">();</span>
<span class="o">//</span><span class="n">mark</span> <span class="n">that</span> <span class="n">a</span> <span class="n">field</span> <span class="n">was</span> <span class="n">added</span> <span class="n">on</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">version</span>
    <span class="n">int32_t</span> <span class="n">get_max_version</span><span class="p">()</span> <span class="p">[</span> <span class="p">[</span><span class="n">version</span> <span class="mf">0.14</span><span class="o">.</span><span class="mi">2</span><span class="p">]</span> <span class="p">];</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">gossip_digest_ack</span> <span class="p">{</span>
    <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">gossip_digest</span><span class="o">&gt;</span> <span class="n">digests</span><span class="p">();</span>
    <span class="n">std</span><span class="p">::</span><span class="nb">map</span><span class="o">&lt;</span><span class="n">inet_address</span><span class="p">,</span> <span class="n">gms</span><span class="p">::</span><span class="n">endpoint_state</span><span class="o">&gt;</span> <span class="n">get_endpoint_state_map</span><span class="p">();</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>

                
                    <div class="post-content"><div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="index.html">
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Design Notes
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="cdc.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />CDC
                </div>
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-right"></i>
                </button>
            </a>
        
    </div>
</div></div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
    </button>
    <div class="side-nav-content">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions">
    <ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
        <li class="scylla-dropdown__item">
            <a class="scylla-dropdown__title" href="#">
                
                    master
                
                <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
            </a>
            <ul class="menu scylla-dropdown__content">
                
                    
                
                    
                        <li>
                            <a href="../../stable/design-notes/IDL.html">4.6</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../branch-4.5/design-notes/IDL.html">4.5</a>
                        </li>
                    
                
                
            </ul>
        </li>
    </ul>
</div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Scylla Developer Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alternator/alternator.html">Alternator: DynamoDB API in Scylla</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../alternator/getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alternator/compatibility.html">Scylla Alternator for DynamoDB users</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Design Notes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">IDL compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdc.html">CDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="compaction_controller.html">The Compaction Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="cql-extensions.html">Scylla CQL extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cql-extensions-internal.html">Scylla CQL extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cql3-type-mapping.html">CQL3 Type Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="hinted_handoff_design.html">Hinted Handoff Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="isolation.html">Performance Isolation in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="lua-type-mapping.html">CQL to Lua type mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">Scylla Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="migrating-from-users-to-roles.html">Migrating from users to roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="paged-queries.html">Paged queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel_aggregations.html">Parallel aggregations</a></li>
<li class="toctree-l2"><a class="reference internal" href="per-partition-rate-limit.html">Per-partition rate limiting</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol-extensions.html">Protocol extensions to the Cassandra Native Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocols.html">Ports and protocols in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="raft-in-scylla.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="raft-in-scylla.html#raft-application-in-scylla">Raft application in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="raft-in-scylla.html#the-group-0">The group 0</a></li>
<li class="toctree-l2"><a class="reference internal" href="raft-in-scylla.html#using-group-0-to-perform-schema-changes">Using Group 0 to perform schema changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis.html">Redis API in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="repair_based_node_ops.html">Repair based node operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="reverse-reads.html">Reverse reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="row_cache.html">Row Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="row_level_repair.html">Row level repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="rust.html">Rust and C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="secondary_index.html">Secondary indexes in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="service_levels.html">Service Level Distributed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sstable-scylla-format.html">File format of the Scylla.db sstable component</a></li>
<li class="toctree-l2"><a class="reference internal" href="sstables-directory-structure.html">sstables directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_keyspace.html">System keyspace layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_keyspace.html#virtual-tables-in-the-system-keyspace">Virtual tables in the system keyspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_schema_keyspace.html">System schema keyspace layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="wasm.html">WASM support for user-defined functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/api_v2.html">Scylla RESTful API V2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/building.html">Building Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/debugging.html">Debugging with GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/docker-hub.html">Docker Hub Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/logging.html">Logging in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/tracing.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/virtual-tables.html">Virtual Tables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contribute/index.html">Contribute</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribute/CONTRIBUTING.html">Contributing to Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/backport.html">Backport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/maintainer.html">Maintainer’s handbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/review-checklist.html">Review Checklist</a></li>
</ul>
</li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/scylla/issues/new?title=Issue in page IDL compiler&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylla.docs.scylladb.com/master/design-notes/IDL%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
                target="_blank">
                <i class="icon fab fa-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                
                
                    
                        
                    
                
                <a href="https://github.com/scylladb/scylla/edit/master/docs/design-notes/IDL.md"
                    target="_blank">
                    <i class="icon fa fa-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">IDL compiler</a><ul>
<li><a class="reference internal" href="#file-syntax-description">File syntax description</a><ul>
<li><a class="reference internal" href="#namespaces">Namespaces</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#enums">Enums</a></li>
<li><a class="reference internal" href="#rpc-verbs">RPC Verbs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#idl-example">IDL example</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com">
                <img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt="Logo" />
            </a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="https://groups.google.com/g/scylladb-users" target="_blank">
                    <span data-tooltip tabindex="1" title="User mailing list" data-position="bottom">
                        <img src="../_static/img/icons/icon-mail-list.svg" alt="Mail List Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <img src="../_static/img/icons/icon-slack.svg" alt="Slack Icon" />
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2022, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 28 June 2022.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.2.2</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>