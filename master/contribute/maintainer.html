

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Maintainer’s handbook | Scylla Docs 
        </title>
        <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://scylla.docs.scylladb.com/stable/contribute/maintainer.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
            
        
    
        
        
            

        <script type="text/javascript" id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
            
        
            
        
            
                <script src="../_static/underscore.js"></script>
            
        
            
                <script src="../_static/doctools.js"></script>
            
        
            
                <script src="../_static/clipboard.min.js"></script>
            
        
            
                <script src="../_static/copybutton.js"></script>
            
        
    
            <!-- Google Tag Manager -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/logo-docs.svg" alt="Scylla Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--about-us"></i>
                            Scylla Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--enterprise"></i>Scylla Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="scylla-icon scylla-icon--overview"></i>
                            Scylla Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Cloud <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://cloud.scylladb.com/">
                            <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
                            Docs</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle" data-toggle="side-nav">
    <div class="side-nav-toggle__button">
        <img src="../_static/img/menu.svg" alt="Menu" />
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for an unstable version of Scylla Dev.
            
            <a href="../../stable/contribute/maintainer.html">Switch to the latest stable version.</a>
        </p>
    </div>

                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://scylla.docs.scylladb.com"
            class="bread__highlight">
            <i class="fas fa-home"></i> Scylla Dev
        </a>
    </span>
    
        <span class="bread__item">
            <a href="index.html">
                Contribute
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Maintainer’s handbook</span>
</div>
                    </div>
                
                <section id="maintainer-s-handbook">
<h1>Maintainer’s handbook<a class="headerlink" href="#maintainer-s-handbook" title="Permalink to this headline">¶</a></h1>
<p>This document describes the mechanics of maintaining Scylla,
as well as a general guideline on what to check when
considering a pull request for merging.</p>
<section id="general-git-tips">
<h2>General git tips<a class="headerlink" href="#general-git-tips" title="Permalink to this headline">¶</a></h2>
<section id="enable-reusing-recorded-resolutions">
<h3>Enable reusing recorded resolutions<a class="headerlink" href="#enable-reusing-recorded-resolutions" title="Permalink to this headline">¶</a></h3>
<p>The command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="k">global</span> <span class="n">rerere</span><span class="o">.</span><span class="n">enabled</span> <span class="n">true</span>
</pre></div>
</div>
<p>will record merge conflict resolutions and replay them
when git encounters the same conflict. This is helpful
when managing multiple branches that see similar conflicts.</p>
</section>
<section id="set-merge-conflictstyle-to-diff3">
<h3>Set merge.conflictstyle to diff3<a class="headerlink" href="#set-merge-conflictstyle-to-diff3" title="Permalink to this headline">¶</a></h3>
<p>The command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="k">global</span> <span class="n">diff</span><span class="o">.</span><span class="n">conflictstyle</span> <span class="o">=</span> <span class="n">diff3</span>
</pre></div>
</div>
<p>will set the conflict markers to three-way diff style.
This records not only “ours” and “theirs”, but also the
common ancestor. This allows the maintainer to see the
intent of each change and aids in resolution.</p>
</section>
<section id="git-submodule-sync">
<h3><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">sync</span></code><a class="headerlink" href="#git-submodule-sync" title="Permalink to this headline">¶</a></h3>
<p>Avoid using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">sync</span></code> as it sets internal state
that is easy to forget, and which can wreak havoc if you do
forget it.
Note that this is only dangerous if you are used to pushing
without a remote, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git push $BRANCH
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">sync</span></code> changes the origin remote on submodules
and so you might push to a remote you didn’t mean to.
If you always specify the remote explicitly when pushing, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git push $REMOTE $BRANCH
</pre></div>
</div>
<p>then using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">sync</span></code> is safe.</p>
</section>
</section>
<section id="applying-patches-and-patch-series">
<h2>Applying patches and patch series<a class="headerlink" href="#applying-patches-and-patch-series" title="Permalink to this headline">¶</a></h2>
<p>Patches can arrive via mailing lists and github pull
requests. Either way, they should be applied to the
<code class="docutils literal notranslate"><span class="pre">next</span></code> branch, not <code class="docutils literal notranslate"><span class="pre">master</span></code>.</p>
<p>Sometimes, patches and patch series have dependencies.
It’s important to verify that those dependencies are
satisfied. In the case of patch series, make sure
the series base contains the dependency, otherwise
bisectability is compromised.</p>
<p>A series base can be found with the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">merge</span><span class="o">-</span><span class="n">base</span> <span class="n">remote</span><span class="o">/</span><span class="n">series_branch_or_tag</span> <span class="n">origin</span><span class="o">/</span><span class="n">master</span>
</pre></div>
</div>
<section id="applying-patches-and-patch-series-from-the-mailing-list">
<h3>Applying patches and patch series from the mailing list<a class="headerlink" href="#applying-patches-and-patch-series-from-the-mailing-list" title="Permalink to this headline">¶</a></h3>
<p>Before you begin, check out the <code class="docutils literal notranslate"><span class="pre">next</span></code> branch and pull
from scylla.git to be up to date. If the pull isn’t clean,
abort the merge and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></code>. Examine the result
to see if you forgot to push a previously applied patch.</p>
</section>
<section id="applying-single-patches-from-the-mailing-list">
<h3>Applying single patches from the mailing list<a class="headerlink" href="#applying-single-patches-from-the-mailing-list" title="Permalink to this headline">¶</a></h3>
<p>Save the patch(es) to some directory, and use the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">am</span> <span class="o">-</span><span class="n">im3</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">patches</span><span class="o">/*.</span><span class="n">eml</span>
</pre></div>
</div>
<p>to apply the patches. <code class="docutils literal notranslate"><span class="pre">-i</span></code> makes the process interactive and
lets you edit the commit message, <code class="docutils literal notranslate"><span class="pre">-m</span></code> sets the Message-Id
tag (which is used by Commit Bot to set the Reply-To header,
so that the commit acknowledgement appears as a response to
the patch), and <code class="docutils literal notranslate"><span class="pre">-3</span></code> enables 3-way merging which is rumored
to reduce conflicts.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> to publish the patches.</p>
</section>
<section id="applying-patch-series-from-the-mailing-list">
<h3>Applying patch series from the mailing list<a class="headerlink" href="#applying-patch-series-from-the-mailing-list" title="Permalink to this headline">¶</a></h3>
<p>Identify the git url and branch/tag identifier, and issue
the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">pull</span> <span class="o">--</span><span class="n">log</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">ff</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">rebase</span> <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">branch</span><span class="o">/</span><span class="n">tag</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--log</span></code> flag generates a list of patches in the commit log,
while <code class="docutils literal notranslate"><span class="pre">--no-ff</span></code> and <code class="docutils literal notranslate"><span class="pre">--no-rebase</span></code> ensure a merge commit is created.</p>
<p>Copy the cover letter subject and body to the merge commit’s
subject and body, respectively. Make sure the merge commit
supplies enough information to understand what the series is
doing without having to read individual commits.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> to publish the patches.</p>
</section>
<section id="applying-patches-and-patch-series-from-github-pull-requests">
<h3>Applying patches and patch series from github pull requests<a class="headerlink" href="#applying-patches-and-patch-series-from-github-pull-requests" title="Permalink to this headline">¶</a></h3>
<p>A common contributor mistake is to base patches on <code class="docutils literal notranslate"><span class="pre">next</span></code>
rather than on <code class="docutils literal notranslate"><span class="pre">master</span></code>. This results in random commits
appearing in the pull request, if <code class="docutils literal notranslate"><span class="pre">next</span></code> is edited for some
reason.</p>
<p>Ensure that the target branch in the pull request page is
set to <code class="docutils literal notranslate"><span class="pre">scylladb:next</span></code> (click Edit and change it if that’s
not the case).</p>
<p>When merging, verify that github didn’t mangle the commit
log, check both your and the contributor’s email address
are correct (no &#64;noreply.users.github.com or similar
address, or home vs. work addresses).</p>
</section>
<section id="applying-pull-requests-with-a-helper-script">
<h3>Applying pull requests with a helper script<a class="headerlink" href="#applying-pull-requests-with-a-helper-script" title="Permalink to this headline">¶</a></h3>
<p>For maintainers’ convenience, a script can be used to properly
prepare a pull request for merging. The script works correctly
both on single- and multi-commit series.
In order to apply a pull request with given number, change the directory
to Scylla’s root source directory and follow the example below.</p>
<ol class="simple">
<li><p>Fetch and checkout the <code class="docutils literal notranslate"><span class="pre">next</span></code> branch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">./scripts/pull_github_pr.sh</span> <span class="pre">${PUT_PULL_REQUEST_NUMBER_HERE}</span></code></p></li>
<li><p>Verify that the merge or cherry-pick was performed correctly</p></li>
<li><p>Push the next branch to the remote repository</p></li>
</ol>
<p>The script can also be used for backports.</p>
</section>
<section id="applying-single-patches-from-github-pull-requests">
<h3>Applying single patches from github pull requests<a class="headerlink" href="#applying-single-patches-from-github-pull-requests" title="Permalink to this headline">¶</a></h3>
<p>Select “Squash and merge” and follow through.</p>
</section>
<section id="applying-patch-series-from-github-pull-requests">
<h3>Applying patch series from github pull requests<a class="headerlink" href="#applying-patch-series-from-github-pull-requests" title="Permalink to this headline">¶</a></h3>
<p>Select “Create a merge commit” and do NOT follow through -
github will attribute itself as the committer. Instead, click
“view command line options”, select the “git pull” line,
paste it to a terminal and add <code class="docutils literal notranslate"><span class="pre">--no-ff</span> <span class="pre">--log</span></code> and execute.</p>
</section>
</section>
<section id="dequeuing-bad-patches">
<h2>Dequeuing bad patches<a class="headerlink" href="#dequeuing-bad-patches" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, a patch fails promotion by Jenkins, or needs to
be dequeued for some other reason. This section explains how.</p>
<ol class="simple">
<li><p>Synchronize with origin by checking out <code class="docutils literal notranslate"><span class="pre">next</span></code> and
issuing a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code></p></li>
<li><p>Issue <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">-i</span> <span class="pre">--rebase-merges</span> <span class="pre">origin/master</span></code></p></li>
<li><p>Identify the final section that contains the pick/merge
command that will contain the result. Ignore any intermediate
sections that describe branches.</p></li>
<li><p>Delete pick/merge commands that correspond to bad commits</p></li>
<li><p>Save the file and let <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> do the work</p></li>
<li><p>Publish your changes with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force-with-lease</span></code></p></li>
</ol>
<p>Note: git contains a bug where branch descriptions with the
characters <code class="docutils literal notranslate"><span class="pre">['&quot;:\.]</span></code> confuse it. Best to search-and-replace those
characters with nothing.</p>
</section>
<section id="updating-submodule-references">
<h2>Updating submodule references<a class="headerlink" href="#updating-submodule-references" title="Permalink to this headline">¶</a></h2>
<p>Submodules are maintained in separate repositories. For example, Seastar
is developed upstream independently of Scylla. We want to periodically
(and upon contributor request) refresh scylla.git to include the
latest submodules.</p>
<ol class="simple">
<li><p>Check out the <code class="docutils literal notranslate"><span class="pre">next</span></code> branch and synchronize it using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code></p></li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">scripts/refresh-submodules.sh</span></code> script, which will open a git
commit log editor for every submodule to show that commits are being
updated.</p></li>
<li><p>Edit the submodule update commits with any necessary additional
imformation. For example, amend the message with <code class="docutils literal notranslate"><span class="pre">Fixes</span></code> tags.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> to publish your work.</p></li>
</ol>
<p>By default refresh-submodules.sh will refresh all submodules from their
master branches. It’s possible to specify submodules and branches as command
line arguments. Each is treated by the script as <code class="docutils literal notranslate"><span class="pre">name[:branch]</span></code>, so for
example the <code class="docutils literal notranslate"><span class="pre">refresh-submodules.sh</span> <span class="pre">seastar</span></code> will only refresh the seastar
submodule and <code class="docutils literal notranslate"><span class="pre">refresh-submodules.sh</span> <span class="pre">seastar:foo</span></code> will do it fetching from
the remote <code class="docutils literal notranslate"><span class="pre">foo</span></code> branch.</p>
</section>
<section id="backporting-patches">
<h2>Backporting patches<a class="headerlink" href="#backporting-patches" title="Permalink to this headline">¶</a></h2>
<p>To backport a patch, check out the next branch of the relevant
release branch (e.g. next-3.2), synchronize it with scylla.git,
and use the cherry-pick command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">cherry</span><span class="o">-</span><span class="n">pick</span> <span class="o">-</span><span class="n">x</span> <span class="o">&lt;</span><span class="n">commit</span> <span class="nb">hash</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>for individual commits, and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">cherry</span><span class="o">-</span><span class="n">pick</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">m</span> <span class="mi">1</span> <span class="o">&lt;</span><span class="n">commit</span> <span class="nb">hash</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>for merge commits. <code class="docutils literal notranslate"><span class="pre">-x</span></code> leaves a reference to the original commit
hash, and <code class="docutils literal notranslate"><span class="pre">-m</span> <span class="pre">1</span></code> indicates which is the “mainline” parent of the
merge commit.</p>
<p>If conflicts cannot be resolved with reasonable effort, ask the
contributor for help.</p>
</section>
<section id="backporting-seastar-commits">
<h2>Backporting Seastar commits<a class="headerlink" href="#backporting-seastar-commits" title="Permalink to this headline">¶</a></h2>
<p>The first time a release branch needs a Seastar backport requires
creating a Seastar branch. This is done in a separate repository:</p>
<ol class="simple">
<li><p>Check out the next branch for your release branch (e.g.
<code class="docutils literal notranslate"><span class="pre">next-3.2</span></code>) and synchronize using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code> to synchronize the submodule</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">seastar</span></code> to enter the submodule</p></li>
<li><p>Create a new branch (e.g. <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">branch-3.2</span></code>)
corresponding to the release series you are backporting to.
Note, the regular branch name is used, not the next branch.</p></li>
<li><p>Use `git push -u scylla-seastar branch-3.2’ to publish the
branch. Note, scylla-seastar here is a git remote that refers
to https://github.com/scylladb/scylla-seastar.git, a
repository used for holding seastar backports for scylla.git.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">..</span></code> to return to scylla.git.</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> to change <code class="docutils literal notranslate"><span class="pre">../seastar</span></code> to <code class="docutils literal notranslate"><span class="pre">../scylla-seastar</span></code>.
This points the seastar submodule at the backports repository.</p></li>
<li><p>Commit with a descriptive message and push to the relevant next
branch.</p></li>
</ol>
<p>After this is done, backporting seastar patches can proceed:</p>
<ol class="simple">
<li><p>Check out the next branch for your release branch (e.g.
<code class="docutils literal notranslate"><span class="pre">next-3.2</span></code>) and synchronize using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code> to synchronize the submodule</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">seastar</span></code> to enter the submodule</p></li>
<li><p>Check out the relevant branch (<code class="docutils literal notranslate"><span class="pre">branch-3.2</span></code> in our example)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span> <span class="pre">&lt;hash&gt;</span></code>
(or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">-x</span> <span class="pre">-m</span> <span class="pre">1</span> <span class="pre">&lt;hash&gt;</span></code>) to backport patches.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> to publish the scylla-seastar.git patches.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">..</span></code> to return to scylla.git.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">summary</span> <span class="pre">seastar</span></code> to create a change log.</p></li>
<li><p>Commit using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">seastar</span></code>, populate change log from
step 8.</p></li>
<li><p>Publish using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>.</p></li>
</ol>
<p>Alternatively</p>
<ul class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">scylla-seastar</span></code> repository</p></li>
</ul>
<ol class="simple">
<li><p>Check out the relevant branch (the <code class="docutils literal notranslate"><span class="pre">branch-3.2</span></code> from the example above)</p></li>
<li><p>Apply all the necessary patches (by cherry-picking them or doing any
other relevant manipulations)</p></li>
<li><p>Push the udpated branch.</p></li>
</ol>
<ul class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">scylla</span></code> repository</p></li>
</ul>
<ol class="simple">
<li><p>Check out the relevant next branch (e.g. <code class="docutils literal notranslate"><span class="pre">next-3.2</span></code> one)</p></li>
<li><p>Use the refreshing script specifying the <code class="docutils literal notranslate"><span class="pre">seastar:&lt;branch&gt;</span></code> as its
first argument (<code class="docutils literal notranslate"><span class="pre">refresh-submodules.sh</span> <span class="pre">seastar:branch-3.2</span></code>)</p></li>
<li><p>Publish with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>.</p></li>
</ol>
</section>
<section id="guidelines-for-merging-pull-requests">
<h2>Guidelines for merging pull-requests<a class="headerlink" href="#guidelines-for-merging-pull-requests" title="Permalink to this headline">¶</a></h2>
<p>This guideline is designed to be a quick checklist, rather
than an exhaustive rulebook on what to accept/reject. One
still has to rely on their judgemenet.</p>
<ol class="simple">
<li><p>Don’t commit your own code.</p></li>
<li><p>Verify that the author has signed the CLA. This is
automatically true for ScyllaDB employees.</p></li>
<li><p>Have a subject matter expert review the code. If you are
not familiar with the modified code, ask one to do a
review. For more details on how to review patches, see
the <a class="reference external" href="https://github.com/scylladb/scylla/blob/master/docs/contribute/review-checklist.md">review checklist</a>.</p></li>
<li><p>If the pull request fixes an issue, it should have a
Fixes or Refs depending on whether the fix is complete or
partial (or just something related).</p></li>
<li><p>Verify that CI job has been run for the latest iteration
of the PR and it passed. CI jobs are automatically
started for pull request submitted through the Github
GUI and their result is posted as a comment to the Github
pull request. This has to be done manually by the
contributor for patches posted to the mailing-list.</p></li>
</ol>
</section>
<section id="guidelines-for-evaluating-backports">
<h2>Guidelines for evaluating backports<a class="headerlink" href="#guidelines-for-evaluating-backports" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>In general backports are only acceptable if they fix an
issue that users of the target version suffer from (or
will suffer from). We don’t backport features or
improvements.</p></li>
<li><p>Backports should <em>always</em> have a reference to the issue
they are related to.</p></li>
<li><p>Backports should be surgical and simple. Only fixing the
target issue, with minimal impact on other code. It is
sometimes preferable to backport a dumbed down, less
perfect fix if the original is very complicated.
If the fixed bug is very bad, more risk is tolerated in
fixing it.</p></li>
<li><p>Backport should be backported to all live releases. There
can be exceptions to this, we may not want to backport to
an old, soon-to-be-EOL’d release, but backports should
never introduce regressions: if a fix is backported to
release X, all releases &gt;X have to get the backport too.</p></li>
<li><p>Riskier fixes should get some “soak-time” in OSS releases
before backported on older stable releases.</p></li>
<li><p>Make sure the target branch is not under freeze, waiting
for an iminent release.</p></li>
</ol>
</section>
</section>

                
                    <div class="post-content"><div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="backport.html">
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Backport
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="review-checklist.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Review Checklist
                </div>
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-right"></i>
                </button>
            </a>
        
    </div>
</div></div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
    </button>
    <div class="side-nav-content">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions">
    <ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
        <li class="scylla-dropdown__item">
            <a class="scylla-dropdown__title" href="#">
                
                    master
                
                <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
            </a>
            <ul class="menu scylla-dropdown__content">
                
                    
                
                    
                        <li>
                            <a href="../../stable/contribute/maintainer.html">4.6</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../branch-4.5/contribute/maintainer.html">4.5</a>
                        </li>
                    
                
                
            </ul>
        </li>
    </ul>
</div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Scylla Developer Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alternator/alternator.html">Alternator: DynamoDB API in Scylla</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../alternator/getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alternator/compatibility.html">Scylla Alternator for DynamoDB users</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../design-notes/index.html">Design Notes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/IDL.html">IDL compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/cdc.html">CDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/compaction_controller.html">The Compaction Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/cql-extensions.html">Scylla CQL extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/cql-extensions-internal.html">Scylla CQL extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/cql3-type-mapping.html">CQL3 Type Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/hinted_handoff_design.html">Hinted Handoff Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/isolation.html">Performance Isolation in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/lua-type-mapping.html">CQL to Lua type mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/metrics.html">Scylla Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/migrating-from-users-to-roles.html">Migrating from users to roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/paged-queries.html">Paged queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/parallel_aggregations.html">Parallel aggregations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/per-partition-rate-limit.html">Per-partition rate limiting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/protocol-extensions.html">Protocol extensions to the Cassandra Native Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/protocols.html">Ports and protocols in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/raft-in-scylla.html">Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/raft-in-scylla.html#raft-application-in-scylla">Raft application in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/raft-in-scylla.html#the-group-0">The group 0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/raft-in-scylla.html#using-group-0-to-perform-schema-changes">Using Group 0 to perform schema changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/redis.html">Redis API in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/repair_based_node_ops.html">Repair based node operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/reverse-reads.html">Reverse reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/row_cache.html">Row Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/row_level_repair.html">Row level repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/rust.html">Rust and C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/secondary_index.html">Secondary indexes in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/service_levels.html">Service Level Distributed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/sstable-scylla-format.html">File format of the Scylla.db sstable component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/sstables-directory-structure.html">sstables directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/system_keyspace.html">System keyspace layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/system_keyspace.html#virtual-tables-in-the-system-keyspace">Virtual tables in the system keyspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/system_schema_keyspace.html">System schema keyspace layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-notes/wasm.html">WASM support for user-defined functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/api_v2.html">Scylla RESTful API V2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/building.html">Building Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/debugging.html">Debugging with GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/docker-hub.html">Docker Hub Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/logging.html">Logging in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/tracing.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/virtual-tables.html">Virtual Tables</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Contribute</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html">Contributing to Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="backport.html">Backport</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Maintainer’s handbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="review-checklist.html">Review Checklist</a></li>
</ul>
</li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/scylla/issues/new?title=Issue in page Maintainer’s handbook&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylla.docs.scylladb.com/master/contribute/maintainer%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
                target="_blank">
                <i class="icon fab fa-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                
                
                    
                        
                    
                
                <a href="https://github.com/scylladb/scylla/edit/master/docs/contribute/maintainer.md"
                    target="_blank">
                    <i class="icon fa fa-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Maintainer’s handbook</a><ul>
<li><a class="reference internal" href="#general-git-tips">General git tips</a><ul>
<li><a class="reference internal" href="#enable-reusing-recorded-resolutions">Enable reusing recorded resolutions</a></li>
<li><a class="reference internal" href="#set-merge-conflictstyle-to-diff3">Set merge.conflictstyle to diff3</a></li>
<li><a class="reference internal" href="#git-submodule-sync"><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">sync</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#applying-patches-and-patch-series">Applying patches and patch series</a><ul>
<li><a class="reference internal" href="#applying-patches-and-patch-series-from-the-mailing-list">Applying patches and patch series from the mailing list</a></li>
<li><a class="reference internal" href="#applying-single-patches-from-the-mailing-list">Applying single patches from the mailing list</a></li>
<li><a class="reference internal" href="#applying-patch-series-from-the-mailing-list">Applying patch series from the mailing list</a></li>
<li><a class="reference internal" href="#applying-patches-and-patch-series-from-github-pull-requests">Applying patches and patch series from github pull requests</a></li>
<li><a class="reference internal" href="#applying-pull-requests-with-a-helper-script">Applying pull requests with a helper script</a></li>
<li><a class="reference internal" href="#applying-single-patches-from-github-pull-requests">Applying single patches from github pull requests</a></li>
<li><a class="reference internal" href="#applying-patch-series-from-github-pull-requests">Applying patch series from github pull requests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dequeuing-bad-patches">Dequeuing bad patches</a></li>
<li><a class="reference internal" href="#updating-submodule-references">Updating submodule references</a></li>
<li><a class="reference internal" href="#backporting-patches">Backporting patches</a></li>
<li><a class="reference internal" href="#backporting-seastar-commits">Backporting Seastar commits</a></li>
<li><a class="reference internal" href="#guidelines-for-merging-pull-requests">Guidelines for merging pull-requests</a></li>
<li><a class="reference internal" href="#guidelines-for-evaluating-backports">Guidelines for evaluating backports</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com">
                <img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt="Logo" />
            </a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="https://groups.google.com/g/scylladb-users" target="_blank">
                    <span data-tooltip tabindex="1" title="User mailing list" data-position="bottom">
                        <img src="../_static/img/icons/icon-mail-list.svg" alt="Mail List Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <img src="../_static/img/icons/icon-slack.svg" alt="Slack Icon" />
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2022, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 28 June 2022.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.2.2</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>